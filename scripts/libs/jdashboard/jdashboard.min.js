/*!
 * jDashboard v2
 * http://codecanyon.net/item/jdashboard/135111
 *
 * Copyright (c) 2010-2012 Sarathi Hansen
 * http://www.codecanyon.net/user/sarthemaker
 *
 * Includes: Cookie plugin
 * http://plugins.jquery.com/project/Cookie
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses
 *
 * Date: September 7th, 2012
 */
(function(e){function o(){this.isCollapsed=!this.isCollapsed;var a=this;this.body.slideToggle(100,function(){"none"===a.body.css("display")&&a.$.addClass("jdash_collapsed")});"block"===this.body.css("display")&&this.$.removeClass("jdash_collapsed");j(this.dashboard)}function p(){(this.isRemoved=!this.isRemoved)?(this.$.addClass("jdash_hidden"),this.style.display="none",this.dashboard.appendChild(this)):(this.$.removeClass("jdash_hidden"),this.style.display="block",this.dashboard.columns[this.dashboard.columns.length-
1].appendChild(this));this.style.display=this.isRemoved?"none":"block";j(this.dashboard)}function j(a){a.options.storageScript?e.ajax({type:"post",url:a.options.storageScript,data:{jdashStorage:k(a),jdashStorageID:a.options.storageID,type:"save"}}):l?localStorage["jdashStorage?dashID:"+a.id+"&storageID:"+a.options.storageID]=k(a):n&&e.cookie("jdashStorage?dashID:"+a.id+"&storageID:"+a.options.storageID,k(a))}function k(a){for(var b="",a=a.$.find(".jdash-widget"),c=a.length;c--;)b+=a[c].id+","+a.eq(c).parent().index()+
","+(a[c].isCollapsed?"1":"0")+","+(a[c].isRemoved?"1":"0"),0<c&&(b+="/");return b}function m(a,b){for(var c,d,f=b.split("/"),g=f.length;g--;)if(c=f[g].split(","),d=document.getElementById(c[0]))("1"===c[3]?(d.$.addClass("jdash_hidden"),d.style.display="none",d.isRemoved=!0,a.appendChild(d)):(d.$.removeClass("jdash_hidden"),d.style.display="block",d.isRemoved=!1,a.columns[parseFloat(c[1])].appendChild(d)),"1"===c[2])?(d.$.addClass("jdash_collapsed").find(".jdash-body").hide(),d.isCollapsed=!0):(d.$.removeClass("jdash_collapsed").find(".jdash-body").show(),
d.isCollapsed=!1);c=a.$.children(".jdash-widget:not(.jdash_hidden)");d=0;for(g=c.length;g--;)a.columns[d].appendChild(c[g]),c[g].isRemoved||(c[g].style.display="block"),d++,d>=a.columns.length&&(d=0);c=e(a.options.controls);c.addClass("jdash-controls");for(d=a.widgets.length;d--;){g=a.widgets[d];f=document.createElement("label");f.innerHTML="<span>"+e(g.$.find(".jdash-header-inner")[0].firstChild).text().replace(/^\s+|\s+$/,"")+"</span>";c.append(f);var h=document.createElement("input");h.type="checkbox";
h.id="jdash-control_"+a.id+"-"+d;h.widget=g;g.isRemoved||(h.checked="checked");h.onclick=function(){e.proxy(p,this.widget)()};e(f).prepend(h)}a.$.trigger("load")}function q(a){if(e(a.target).hasClass("jdash-collapse")||e(a.target).parents().is(".jdash-toolbar"))return!1;if(!this.isDragInit&&!this.isDragging){var b=this.$.offset();this.dragOffsetLeft=b.left;this.dragOffsetTop=b.top;this.clickOffsetLeft=a.pageX-b.left;this.clickOffsetTop=a.pageY-b.top;this.isDragInit=!0}return!1}function r(){this.widgets.each(function(){if(this.isDragging){var a=
this.$.offset();this.style.marginBottom=-this.offsetHeight-parseFloat(this.$.css("marginTop"))+"px";this.style.top=a.top-this.dashboard.sector.$.offset().top+"px";this.style.left=a.left-this.dashboard.sector.$.parent().offset().left-parseFloat(this.$.css("marginLeft"))+"px";this.$.insertBefore(this.dashboard.sector.$);this.$.animate({left:0,top:0},200,"",function(){this.style.marginBottom=this.$.css("marginTop");this.dashboard.sector.$.hide();this.$.removeClass("jdash_dragging")});j(this.dashboard)}this.isDragging=
this.isDragInit=!1})}function s(a){this.widgets.each(function(){this.isDragInit&&!this.isDragging&&(this.isDragging=!0,this.isDragInit=!1,this.$.addClass("jdash_dragging"),this.style.marginBottom=-this.$.outerHeight()-parseFloat(this.$.css("marginTop"))+"px",this.dashboard.sector.$.insertAfter(this),this.dashboard.sector.style.display="block",this.dashboard.sector.style.height=this.$.height()+"px");if(this.isDragging){40>a.clientY&&window.scrollBy(0,-10);a.clientY>e(window).height()-40&&window.scrollBy(0,
10);this.style.left=a.pageX-this.dragOffsetLeft-this.clickOffsetLeft+"px";this.style.top=a.pageY-this.dragOffsetTop-this.clickOffsetTop+"px";a:{var b,c,d=this.$.offset(),f=d.left+this.offsetWidth/2,g=this.dashboard.sector.$.parent();if(g.prev(".jdash-column").length&&(b=g.prev()[0])&&f+10<b.$.offset().left+b.offsetWidth)b.appendChild(this.dashboard.sector),i(this,a);else if(g.next(".jdash-column").length&&(b=g.next()[0])&&f-10>b.$.offset().left)b.appendChild(this.dashboard.sector),i(this,a);if(this.dashboard.sector.$.not(":first-child")&&
(c=this.dashboard.sector.$.prev()[0]))if(c===this&&(c=c.$.prev()[0]),c&&d.top+10<c.$.offset().top+c.offsetHeight/2){c.parentNode.insertBefore(this.dashboard.sector,c);i(this,a);break a}if(this.dashboard.sector.$.not(":last-child")&&(c=this.dashboard.sector.$.next()[0]))c===this&&(c=c.$.next()[0]),c&&d.top+this.offsetHeight-10>c.$.offset().top+c.offsetHeight/2&&(c.parentNode.insertBefore(this.dashboard.sector,c.nextSibling),i(this,a))}}})}function i(a,b){var c=a.$.offset();a.dragOffsetLeft=c.left-
parseFloat(a.$.css("left"));a.dragOffsetTop=c.top-parseFloat(a.$.css("top"));a.style.left=b.pageX-a.dragOffsetLeft-a.clickOffsetLeft+"px";a.style.top=b.pageY-a.dragOffsetTop-a.clickOffsetTop+"px"}var l=null!==window.localStorage;if(!l){e.cookie=function(a,b,c){if("undefined"!=typeof b){c=c||{};null===b&&(b="",c.a=-1);var d="";if(c.a&&("number"==typeof c.a||c.a.toUTCString))"number"==typeof c.a?(d=new Date,d.setTime(d.getTime()+864E5*c.a)):d=c.a,d="; expires="+d.toUTCString();document.cookie=[a,"=",
encodeURIComponent(b),d,c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.b?"; secure":""].join("")}else{b=null;if(document.cookie&&""!=document.cookie){c=document.cookie.split(";");for(d=0;d<c.length;d++){var f=e.trim(c[d]);if(f.substring(0,a.length+1)==a+"="){b=decodeURIComponent(f.substring(a.length+1));break}}}return b}};e.cookie("jdashCookiesOn","1");var n="1"===e.cookie("jdashCookiesOn");e.cookie("jdashCookiesOn",null)}e.fn.jDashboard=function(a){a=e.extend({columns:2,storage:"local"},
a);return this.each(function(){this.$=e(this).addClass("jdash");this.options=a;this.columnWidth=a.columnWidth?a.columnWidth:100/a.columns+"%";for(var b=[],c,d=this.options.columns;d--;)c=document.createElement("div"),c.$=e(c).addClass("jdash-column").css({width:this.columnWidth}).appendTo(this),b.push(c);this.$.append('<div class="clear"></div>');this.columns=b;c=this.$.find(".jdash-widget");for(d=c.length;d--;)b=c[d],b.$=c.eq(d),b.originalIndex=d,b.dashboard=this,b.body=b.$.find(".jdash-body"),b.body.children(".jdash-info").append('<div class="jdash-info-arrow_fill"></div><div class="jdash-info-arrow_stroke"></div>'),
b.isDragInit=b.isDragging=b.isCollapsed=b.isRemoved=!1,b.dragOffsetLeft=b.dragOffsetTop=b.clickOffsetLeft=b.clickOffsetTop=0,b.$.hasClass("jdash_collapsed")&&(b.isCollapsed=!0,b.body.hide()),b.$.hasClass("jdash_hidden")&&(b.isRemoved=!0,b.style.display="none",this.appendChild(b)),b.$.find(".jdash-header").html(b.$.find(".jdash-header").html().replace(/^\s+/,"")),b.$.find(".jdash-header").append(e(document.createElement("div")).addClass("jdash-collapse").bind("click",e.proxy(o,b))).wrapInner('<div class="jdash-header-inner" />').bind("mousedown",
e.proxy(q,b));this.widgets=c;b=document.createElement("div");b.$=e(b).addClass("jdash-sector");this.appendChild(b);this.sector=b;var f=this;f.options.storageScript?e.ajax({type:"post",url:f.options.storageScript,data:{jdashStorageID:f.options.storageID,type:"load"},success:function(a){m(f,a)}}):l?(b=localStorage.getItem("jdashStorage?dashID:"+f.id+"&storageID:"+f.options.storageID),m(f,b?b:"")):n&&(b=e.cookie("jdashStorage?dashID:"+f.id+"&storageID:"+f.options.storageID),m(f,b?b:""));e(document).bind({mousemove:e.proxy(s,
this),mouseup:e.proxy(r,this)})})}})(jQuery);